{
  "comment": "Generate PKCS7/CAdES-signature",
  "comment1a": "Для коректного відображення utf8 тексту под ОС Windows",
  "comment1b": "треба перед запуском теста в терміналі ввести 'chcp 65001'",
  "comment1c": "або ввімкнути підтримку utf8 в терміналі для всієї ОС Windows 10",
  "comment2": "Локаль за замовчуванням: 'locale'='', мінімальна C-локаль: 'locale'='C'",
  "tasks": [
    {
      "method": "VERSION"
    },
    {
      "comment": "Ініціалізація бібліотеки",
      "method": "INIT",
      "parameters": {
        "cmProviders": {
          "dir": "", // full path
          "allowedProviders": [
            {
              "lib": "cm-pkcs12",
              "config": { // optional parameters
                "createPfx": { // specific parameters
                  "bagCipher": "2.16.840.1.101.3.4.1.22",
                  "bagKdf": "1.2.840.113549.2.10",
                  "iterations": 2000,
                  "macAlgo": "2.16.840.1.101.3.4.2.2"
                }
              }
            }
          ]
        },
        "certCache": {
          "path": "certs/", // full path
          "trustedCerts": []
        }
      }
    },
    {
      "comment": "Відкриття носія ключів",
      "method": "OPEN",
      "parameters": {
        "provider": "PKCS12", // Опціональний, по замовчанню PKCS12
        "storage": "memory", // Для PKCS12-provider обов'язковий, шлях до контейнера PKCS#8,PKCS#12,JKS,IIT. Якщо контейнер ключів зберігається у пам'яті, то використовуються будь-яка строка (наприклад "memory").
        "password": "Test", // Для PKCS12 обов'язковий, пароль
        "mode": "RO", // Опціональний, RO - тільки читання, RW - читання/запис, CREATE - створення
        "openParams": {
          "bytes": "MIIE4wIBAzCCBIAGCSqGSIb3DQEHAaCCBHEEggRtMIIEaTCCBGUGCSqGSIb3DQEHAaCCBFYEggRSMIIETjCCAfIGCyqGSIb3DQEMCgECoIIBrjCCAaowgbAGCSqGSIb3DQEFDTCBojBDBgkqhkiG9w0BBQwwNgQgV2qtQEAUEBJFxL/32RCWEbbCCSPZVOg8v0dHKqxU/T8CAicQMA4GCiqGJAIBAQEBAQIFADBbBgsqhiQCAQEBAQEBAzBMBAgamOsuY5vEygRAqdbrRfE8cIKAxJZ7Ix9erfZY66TANykdONlr8CXKThf46XINxhW0OiiXXwvB3qNkOLVk6iwXn9ASPm24+sV5BASB9JWXxCMdTHbHO/3cV2Rh26FCT/x6vQx5ramNwAwWms1sKB+FiCilrgDAqj23ccPlsE82mLZ5Ui3oACHIs/XJarRskrkj2W9DLTIQb8+eL7hrZ4MClwVO+Kmx+W+U0fWiKHT6t/XhlGJSlhg66J3fRRT6nAxFpHOaxi4fe+MwsLKyiP7WZjvUxsZSZDJQn+heTeeB3a0PKdqnPWdnCBOTRIYGfZO1aTh5qvXOhxwQUWuKnFare5VbNbxsC3JiWCoNQNdJCe4ZVbQlBun4YziMNxGiGWB007x85TgY07fkrh0lX85zSgYSIMVSg+eagdkA/5O2i94xMTAvBgkqhkiG9w0BCRUxIgQgW8bAbuHgDBcA6Sqnqa11+C08t6m2bjqYAjIJskUTMVwwggJUBgsqhkiG9w0BDAoBAqCCAhAwggIMMIGwBgkqhkiG9w0BBQ0wgaIwQwYJKoZIhvcNAQUMMDYEILBoPpAJ3D81IH/906O/9Uzget6oMKvhOckDE9dVM2vRAgInEDAOBgoqhiQCAQEBAQECBQAwWwYLKoYkAgEBAQEBAQMwTAQIqPLW3Ud0X18EQKnW60XxPHCCgMSWeyMfXq32WOukwDcpHTjZa/Alyk4X+OlyDcYVtDool18Lwd6jZDi1ZOosF5/QEj5tuPrFeQQEggFVm31YVohnsVa+L95jmxmCZ0CHuAJNn1anriubn5IGI4MRoH9ofgfC/ISo3wqKrAQAQdC/4NAyTdMQ7uMAqSptSyqSGFMboCDwv/YHz1ceoHF1+SVkySrP5EOGgrF0VBFsVzXbFCPcytgPYdgF0PAHbLZipENMz0Mf9nzoWAQzpEaz/zYXUhYBaPZNnUqRqtLu2BlW0Bz+lhIVco47cv1FtpBm6a7k0LSN8eOI34aDM50Lmw6D+RBZ9d/UlbDL2HSiSlXKn18IhSPPzqEw9CDKfoIoHX6N7pFFjCHWCm9wd/bfm6N7ricb5+DN5vFwW8zC12cuPZTIwwn3+IRdIQxsMeLLUGtYC/CmiZZ7eECF5X1gW5FashzpIl753+RQnSfqtjbuKWFgR4PwRgbFxK3bRO1qzn4PCC3sw5gZMZnxzCW88i1QIF9QIrO9y5L8frf3jzfKllgxMTAvBgkqhkiG9w0BCRUxIgQgaxt3wNGhtgRzqY3W1P5TAnQq7eEB2qIfLIOmfM3tt4IwWjAyMA4GCiqGJAIBAQEBAgEFAAQgJxu4d1YOPccXGhs2E7d6iwxt/AyeHg9jZIJ897zLflYEIMuXfe6AaRLQIwS6zphOifYjYzNMUGw+MTvyMsX+IPnZAgInEA=="
        }
      }
    },
    {
      "comment": "Отримання переліку ключів на відкритому носії",
      "method": "KEYS"
    },
    {
      "comment": "Обрання ключа з переліку ключів на носії (та отримання його сертифікату)",
      "method": "SELECT_KEY",
      "parameters": {
        "id": "5BC6C06EE1E00C1700E92AA7A9AD75F82D3CB7A9B66E3A98023209B24513315C" // обов'язковий, ідентифікатор ключа
      }
    },
    {
      "comment": "формування підпису. Параметри наступні: CMS, attached data",
      "method": "SIGN",
      "parameters": {
        "signParams": {
          "signatureFormat": "CAdES-BES",
          "signAlgo": "1.2.804.2.1.1.1.1.3.1.1", // Опціональний, якщо не вказаний, то використовується перший алгоритм підпису із списку signAlgo для ключа
          //"digestAlgo": "1.2.804.2.1.1.1.1.2.1", // Опціональний
          "detachedData": false, // Опціональний, по замовчанню true (дані не інкапсулюються)
          "includeCert": true, // Опціональний, по замовчанню false (додати до підпису сертифікат)
          "includeTime": true, // Опціональний, по замовчанню false (додати до підпису час хосту (не довірений))
          "includeContentTS": false // Опціональний, по замовчанню false (додати до підпису TSP від даних)
        },
        "dataTbs": [
          {
            "id": "doc-0", // Обов'язковий, ідентифікатор даних
            "bytes": "VGhlIHF1aWNrIGJyb3duIGZveCBqdW1wcyBvdmVyIHRoZSBsYXp5IGRvZw==" // обов'язковий, дані для підпису у кодировці base64
          }
        ]
      }
    },
    {
      "method": "CLOSE"
    },
    {
      "method": "DEINIT"
    }
  ]
}